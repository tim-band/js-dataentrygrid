# js-dataentrygrid

Featherweight Excel-like grid for data entry

Build with `npm install .` then `npm run build`. Run tests with `npm run test`
or `npm run test-firefox`. You can run just one test by adding
`-- --fgrep "test title"`. Update the `README.md` documentation
with `npm run docs`.

Has the following features:

*   Click to edit
*   Navigate with Tab and Return
*   Auto-insert rows at the end
*   Right-click menu with:
    *   delete rows
    *   insert rows
*   Undo and Redo
*   Multiple row and column selections
*   Copy and paste
*   Clearing cells with Delete or Backspace
*   Arrow key (plus Home, End and Page keys) navigation
*   Starting to type forces the input box to open
*   Copy and paste to and from Excel/LibreOffice
*   Shift-arrows to extend selection
*   Multiple row add/delete
*   Localization
*   Useful API
*   Provide undo and redo buttons
*   Row/Column/Table header click to select
*   Unfixed headers (so columns can be added and deleted, headers
    are A,B,C...)
*   Unit switchers in subheaders

but lacking:

*   Accessibility testing
*   Touch screen support?

## Changes

### v2.0

*   Removal of function `getColumnSubheader`. You should no longer
    fill in subheader cells yourself.
*   `init` gains two new arguments: `subheaderSpecs` and `subheaderDefaults`.
*   Addition of function `getSubheaders`.
*   Addition of function `setReunittingFunction`.

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

*   [createDataEntryGrid](#createdataentrygrid)
    *   [Parameters](#parameters)
*   [init](#init)
    *   [Parameters](#parameters-1)
*   [extendRows](#extendrows)
    *   [Parameters](#parameters-2)
*   [setText](#settext)
    *   [Parameters](#parameters-3)
*   [setButtons](#setbuttons)
    *   [Parameters](#parameters-4)
*   [getSelection](#getselection)
*   [setSelection](#setselection)
    *   [Parameters](#parameters-5)
*   [rowCount](#rowcount)
*   [columnCount](#columncount)
*   [getColumnHeaders](#getcolumnheaders)
*   [getSubheaders](#getsubheaders)
*   [reunitter](#reunitter)
    *   [Parameters](#parameters-6)
*   [setReunittingFunction](#setreunittingfunction)
    *   [Parameters](#parameters-7)
*   [goToCell](#gotocell)
    *   [Parameters](#parameters-8)
*   [getCells](#getcells)
    *   [Parameters](#parameters-9)
*   [putCells](#putcells)
    *   [Parameters](#parameters-10)
*   [clearData](#cleardata)
*   [getColumn](#getcolumn)
    *   [Parameters](#parameters-11)
*   [clearUndo](#clearundo)
*   [undo](#undo)
*   [redo](#redo)
*   [nullary](#nullary)
*   [addWatcher](#addwatcher)
    *   [Parameters](#parameters-12)
*   [getTable](#gettable)

### createDataEntryGrid

Initialize an HTML table to be a data entry grid.

#### Parameters

*   `containerId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** id of the `table` element you want to make interactive
*   `headers` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** array of strings to become the new column headers
    or the number of columns to be created. If a number is given, the columns will be
    named 'A', 'B', 'C' and so on, and the set of columns will be able to be added and
    deleted. If an array of strings is given, the columns will be fixed.
*   `newRowCount` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** number of rows the table should now have

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The table object.

### init

Re-initializes the table.

Any reunitting function is removed.

#### Parameters

*   `headers` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** Array of strings to become the new
    column headers, or the number of columns to create for 'flexible columns'
    (if column addition and deletion is required).
*   `rows` **([number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number) | [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>>)** Number of rows the table should now
    have, or array of rows, each of which is an array of the cells in that row.
    Any row longer than the headers array is truncated.
*   `subheaderSpecs` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)>?** List of option specifications (one
    per column). Each is a map of names to display strings of the options.
    Not permitted with flexible columns.
*   `subheaderDefaults` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>?** List of names that are the initial
    settings of the subheader selects. Not permitted with flexible columns.

### extendRows

Adds empty rows to the bottom of the table if necessary.

#### Parameters

*   `rows` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The total number of rows the table should
    have after the call. If the table already had this many no more will
    be added and none will be taken away.

### setText

Sets localized text for the row header context table.

#### Parameters

*   `newText` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Text of table ids to strings. The ids currently
    recognized are 'cut', 'copy', `deleteRow`, `addRowBefore`, `addRowAfter`,
    `deleteColumn`, `addColumnBefore` and `addColumnAfter`.

### setButtons

Sets existing buttons on the page to be functional undo and redo
buttons, including becoming disabled when the appropriate stack
is exhausted.

#### Parameters

*   `undoButton` **[HTMLButtonElement](https://developer.mozilla.org/docs/Web/API/HTMLButtonElement)** Button to set as undo
    button (or null)
*   `redoButton` **[HTMLButtonElement](https://developer.mozilla.org/docs/Web/API/HTMLButtonElement)** Button to set as redo
    button (or null)

### getSelection

Gets the position and size of the selection.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** the position of the selection given by the
following keys: `anchorRow`, `anchorColumn`, `selectionRow`,
`selectionColumn`.

### setSelection

Sets the position and size of the selection.

#### Parameters

*   `anchorRow` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The row the anchor is in
*   `anchorColumn` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The column the anchor is in
*   `selectionRow` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The other end of the
    selected rows (optional, default `anchorRow`)
*   `selectionColumn` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The other end
    of the selected columns (optional, default `anchorColumn`)

### rowCount

Returns the number of rows.

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** of rows in the table

### columnCount

Returns the number of columns.

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** of columns in the table

### getColumnHeaders

Returns the column headers.

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of strings.

### getSubheaders

Returns selected options in subheaders

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of strings

### reunitter

A function for changing a column in response to a subheader's
value changing.

Type: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)

#### Parameters

*   `columnIndex` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Which column is being changed
*   `oldValue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The value that the subheader is being changed from
*   `newValue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The value that the subheader is being changed from
*   `columnValues` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** The current values in the column

Returns **(null | [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>)** The new values the column should have, or null
if they should be unchanged.

### setReunittingFunction

Sets a function to be called whenever a subheader is changed.
This function can change the values in the column.

#### Parameters

*   `fn` **[reunitter](#reunitter)** 

### goToCell

Moves the anchor (and selection to the same place)

#### Parameters

*   `r` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** row to go to
*   `c` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** column to go to

### getCells

Gets the text of the cells requested.

#### Parameters

*   `rowStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first row (zero-based) (optional, default `0`)
*   `rowEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** one past the last row, defaults to
    (one past) the last row
*   `columnStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first column (optional, default `0`)
*   `columnEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** one past the last column, defaults
    to (one past) the last column

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>>** The cell contents

### putCells

Gets the text of the cells requested.

#### Parameters

*   `rowStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first row (zero-based)
*   `rowEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** one past the last row
*   `columnStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first column
*   `columnEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** one past the last column
*   `values` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>>** an array of arrays of new cell values.

### clearData

Clears all the data, leaving the headers and number of rows
untouched. This clearing goes on the undo stack.

### getColumn

Gets the text of the cells of one column.

#### Parameters

*   `column` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** index of the column to return

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** data from that column

### clearUndo

Clear the undo and redo stacks.

### undo

Undoes the last action done or redone.

### redo

Redoes the last undone action.

### nullary

Nullary function as a callback

Type: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)

### addWatcher

Adds a watcher function that is called every time the content of the
table changes (excluding the subheader cells).

#### Parameters

*   `watcher` **[nullary](#nullary)** The new watcher to add.

### getTable

Returns the table element.

Returns **[HTMLTableElement](https://developer.mozilla.org/docs/Web/API/HTMLTableElement)** 

## createDataEntryGrid

Initialize an HTML table to be a data entry grid.

### Parameters

*   `containerId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** id of the `table` element you want to make interactive
*   `headers` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** array of strings to become the new column headers
    or the number of columns to be created. If a number is given, the columns will be
    named 'A', 'B', 'C' and so on, and the set of columns will be able to be added and
    deleted. If an array of strings is given, the columns will be fixed.
*   `newRowCount` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** number of rows the table should now have

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The table object.

## init

Re-initializes the table.

### Parameters

*   `headers` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** Array of strings to become the new
    column headers, or the number of columns to create if column addition
    and deletion is required.
*   `rows` **([number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number) | [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>>)** Number of rows the table should now
    have, or array of rows, each of which is an array of the cells in that row.
    Any row longer than the headers array is truncated.
*   `subheaderSpecs` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)>?** List of option specifications (one
    per column). Each is a map of names to display strings of the options.
*   `subheaderDefaults` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>?** List of names that are the initial
    settings of the subheader selects.

## extendRows

Adds empty rows to the bottom of the table if necessary.

### Parameters

*   `rows` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The total number of rows the table should
    have after the call. If the table already had this many no more will
    be added and none will be taken away.

## setText

Sets localized text for the row header context table.

### Parameters

*   `newText` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Text of table ids to strings. The ids currently
    recognized are 'cut', 'copy', `deleteRow`, `addRowBefore`, `addRowAfter`,
    `deleteColumn`, `addColumnBefore` and `addColumnAfter`.

## setButtons

Sets existing buttons on the page to be functional undo and redo
buttons, including becoming disabled when the appropriate stack
is exhausted.

### Parameters

*   `undoButton` **[HTMLButtonElement](https://developer.mozilla.org/docs/Web/API/HTMLButtonElement)** Button to set as undo
    button (or null)
*   `redoButton` **[HTMLButtonElement](https://developer.mozilla.org/docs/Web/API/HTMLButtonElement)** Button to set as redo
    button (or null)

## getSelection

Gets the position and size of the selection.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** the position of the selection given by the
following keys: `anchorRow`, `anchorColumn`, `selectionRow`,
`selectionColumn`.

## setSelection

Sets the position and size of the selection.

### Parameters

*   `anchorRow` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The row the anchor is in
*   `anchorColumn` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The column the anchor is in
*   `selectionRow` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The other end of the
    selected rows (optional, default `anchorRow`)
*   `selectionColumn` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The other end
    of the selected columns (optional, default `anchorColumn`)

## rowCount

Returns the number of rows.

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** of rows in the table

## columnCount

Returns the number of columns.

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** of columns in the table

## getColumnHeaders

Returns the column headers.

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of strings.

## getSubheaders

Returns selected options in subheaders

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of strings

## goToCell

Moves the anchor (and selection to the same place)

### Parameters

*   `r` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** row to go to
*   `c` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** column to go to

## getCells

Gets the text of the cells requested.

### Parameters

*   `rowStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first row (zero-based) (optional, default `0`)
*   `rowEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** one past the last row, defaults to
    (one past) the last row
*   `columnStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first column (optional, default `0`)
*   `columnEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** one past the last column, defaults
    to (one past) the last column

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>>** The cell contents

## putCells

Gets the text of the cells requested.

### Parameters

*   `rowStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first row (zero-based)
*   `rowEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** one past the last row
*   `columnStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first column
*   `columnEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** one past the last column
*   `values` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>>** an array of arrays of new cell values.

## clearData

Clears all the data, leaving the headers and number of rows
untouched. This clearing goes on the undo stack.

## getColumn

Gets the text of the cells of one column.

### Parameters

*   `column` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** index of the column to return

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** data from that column

## clearUndo

Clear the undo and redo stacks.

## undo

Undoes the last action done or redone.

## redo

Redoes the last undone action.

## nullary

Nullary function as a callback

Type: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)

## addWatcher

Adds a watcher function that is called every time the content of the
table changes (excluding the subheader cells).

### Parameters

*   `watcher` **[nullary](#nullary)** The new watcher to add.

## getTable

Returns the table element.

Returns **[HTMLTableElement](https://developer.mozilla.org/docs/Web/API/HTMLTableElement)**
