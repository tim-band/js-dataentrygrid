# js-dataentrygrid

Featherweight Excel-like grid for data entry

Build with `npm install .` then `npm run build`.

At the moment, just an HTML proof-of-concept with the following features:

-   Click to edit
-   Navigate with Tab and Return
-   Auto-insert rows at the end
-   Right-click menu with:
    -   delete rows
    -   insert rows
-   Undo and Redo
-   Multiple row and column selections
-   Copy and paste
-   Clearing cells with Delete or Backspace
-   Arrow key (plus Home, End and Page keys) navigation
-   Starting to type forces the input box to open
-   Copy and paste to and from Excel/LibreOffice
-   Shift-arrows to extend selection
-   Multiple row add/delete
-   Localization
-   Useful API
-   Provide undo and redo buttons
-   Row/Column/Table header click to select
-   Unfixed headers (so columns can be added and deleted, headers
    are A,B,C...)

but lacking:

-   Accessibility testing
-   Touch screen support?

# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [createDataEntryGrid](#createdataentrygrid)
    -   [Parameters](#parameters)
-   [init](#init)
    -   [Parameters](#parameters-1)
-   [extendRows](#extendrows)
    -   [Parameters](#parameters-2)
-   [setText](#settext)
    -   [Parameters](#parameters-3)
-   [setButtons](#setbuttons)
    -   [Parameters](#parameters-4)
-   [getSelection](#getselection)
-   [setSelection](#setselection)
    -   [Parameters](#parameters-5)
-   [rowCount](#rowcount)
-   [columnCount](#columncount)
-   [getColumnHeaders](#getcolumnheaders)
-   [goToCell](#gotocell)
    -   [Parameters](#parameters-6)
-   [getCells](#getcells)
    -   [Parameters](#parameters-7)
-   [putCells](#putcells)
    -   [Parameters](#parameters-8)
-   [clearData](#cleardata)
-   [getColumn](#getcolumn)
    -   [Parameters](#parameters-9)
-   [clearUndo](#clearundo)
-   [undo](#undo)
-   [redo](#redo)

## createDataEntryGrid

Initialize an HTML table to be a data entry grid.

### Parameters

-   `containerId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** id of the `table` element you want to make interactive
-   `headers` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** array of strings to become the new column headers
    or the number of columns to be created. If a number is given, the columns will be
    named 'A', 'B', 'C' and so on, and the set of columns will be able to be added and
    deleted. If an array of strings is given, the columns will be fixed.
-   `newRowCount` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** number of rows the table should now have

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** The table object.

## init

Re-initializes the table.

### Parameters

-   `headers` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** Array of strings to become the new
    column headers, or the number of columns to create if column addition
    and deletion is required.

## extendRows

Adds empty rows to the bottom of the table if necessary.

### Parameters

-   `rows` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The total number of rows the table should
    have after the call. If the table already had this many no more will
    be added and none will be taken away.

## setText

Sets localized text for the row header context table.

### Parameters

-   `newText` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Text of table ids to strings. The ids currently
    recognized are 'cut', 'copy', `deleteRow`, `addRowBefore`, `addRowAfter`,
    `deleteColumn`, `addColumnBefore` and `addColumnAfter`.

## setButtons

Sets existing buttons on the page to be functional undo and redo
buttons, including becoming disabled when the appropriate stack
is exhausted.

### Parameters

-   `undoButton` **[HTMLButtonElement](https://developer.mozilla.org/docs/Web/API/HTMLButtonElement)** Button to set as undo
    button (or null)
-   `redoButton` **[HTMLButtonElement](https://developer.mozilla.org/docs/Web/API/HTMLButtonElement)** Button to set as redo
    button (or null)

## getSelection

Gets the position and size of the selection.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** the position of the selection given by the
following keys: `anchorRow`, `anchorColumn`, `selectionRow`,
`selectionColumn`.

## setSelection

Sets the position and size of the selection.

### Parameters

-   `anchorRow` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The row the anchor is in
-   `anchorColumn` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The column the anchor is in
-   `selectionRow` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The other end of the
    selected rows (optional, default `anchorRow`)
-   `selectionColumn` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The other end
    of the selected columns (optional, default `anchorColumn`)

## rowCount

Returns the number of rows.

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** of rows in the table

## columnCount

Returns the number of columns.

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** of columns in the table

## getColumnHeaders

Returns the column headers.

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of strings.

## goToCell

Moves the anchor (and selection to the same place)

### Parameters

-   `r` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** row to go to
-   `c` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** column to go to

## getCells

Gets the text of the cells requested.

### Parameters

-   `rowStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first row (zero-based) (optional, default `0`)
-   `rowEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** one past the last row, defaults to
    (one past) the last row
-   `columnStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first column (optional, default `0`)
-   `columnEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** one past the last column, defaults
    to (one past) the last column

## putCells

Gets the text of the cells requested.

### Parameters

-   `rowStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first row (zero-based)
-   `rowEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** one past the last row
-   `columnStart` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** first column
-   `columnEnd` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** one past the last column
-   `values`  

## clearData

Clears all the data, leaving the headers and number of rows
untouched. This clearing goes on the undo stack.

## getColumn

Gets the text of the cells of one column.

### Parameters

-   `column` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** index of the column to return

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** data from that column

## clearUndo

Clear the undo and redo stacks.

## undo

Undoes the last action done or redone.

## redo

Redoes the last undone action.
